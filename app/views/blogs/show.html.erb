<%# 詳細ブログ記事ページ %>
<%= render "shared/header"%>

<div class="main-content">
 <div class="blog-contents">
    <div class="blog_image_content">
     <%= link_to blog_path(@blog.id) do %>
      <div class="blog-image"> 
       <% if @blog.image != 0 %>
        <%= image_tag @blog.image.variant(resize:'300x300'), class: "blog-image" %>
       <% else %>
         <%# 画像がない時のイメージ %>
        <%= link_to image_tag "neco.jpeg", class: "blog-img"%>
       <% end %>
      </div>
     <% end %>
    </div>
   <h3 class="blog-title">
    <%= @blog.title %>
   </h3>
  <div class="blog-report">
   <%= @blog.text%>
  </div>
    <%# 自分のブログだと編集・削除・コメント閲覧 %>
  <% if user_signed_in? && current_user.id == @blog.user_id  %>
   <%= link_to "編集する", edit_blog_path, class:"edit-btn"%>
   or
   <%= link_to "削除する", blog_path, method: :delete, class:"delete-btn"%>
    <div class="blog-comment">
      <h4> < コメント一覧 > </h4>
      <% if @comments %>
       <% @comments.each do |comment| %>
       <p>
        <strong><%= link_to comment.user.nickname, "/users/#{comment.user_id}" %>:</strong>
        <%= comment.text %>
        <%= comment.created_at%>
       </p>
       <% end %>
      <% end %>
    </div>
  <%else%>
   <%# その人の別のブログ記事へ飛べるorコメントする %>
   <div class="comment-form">
    <%= form_with(model: [@blog, @comment], local: true) do |f| %>
     <%= f.text_area :text, placeholder: "コメントする", rows: "2" %>
     <%= f.submit "投稿する" %>
    <% end %> 
   </div>
   <div class="blog-comment">
      <h4> < コメント一覧 > </h4>
      <% if @comments %>
       <% @comments.each do |comment| %>
        <p>
         <strong><%= link_to comment.user.nickname, "/users/#{comment.user_id}" %>:</strong>
         <%= comment.text %>
         <%= comment.created_at%>
        </p>
       <% end %>
      <% end %>
   </div>
    <%# 他の記事にとべる設定        設定途中 %>
   <div class="links">
    <a href="#" class="change-blog-btn">
      ＜ 前の記事
    </a>
    <a href="#" class="change-blog-btn">
      後ろの記事 ＞
    </a>
   </div>
    <a href="#" class='another-blog'><%= @blog.user.nickname %>さんのブログをもっと見る</a>
  <%end%>
    <div class="actions">
     <%= link_to "戻る", root_path, class:"return-btn" %> 
  </div>
 </div>
</div>
